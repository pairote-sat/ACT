

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data Manipulation &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Data_Manipulation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Dealing with Problematic Data" href="Dealing_with_Problematic_Data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Data Wrangling with Pandas
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Data_Preparation_with_Pandas.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_Selection.html">Data Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dealing_with_Problematic_Data.html">Dealing with Problematic Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data Manipulation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FData_Manipulation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Data_Manipulation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Manipulation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-new-column-to-an-existing-pandas-dataframe">Add A New Column To An Existing Pandas DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appending-a-row-to-a-dataframe-and-specify-its-index-label">Appending a row to a dataframe and specify its index label</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting">Sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-data">Grouping Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-pivot-tables">Introduction to Pivot Tables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplest-pivot-table">Simplest Pivot table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-non-numeric-columns-in-pivot-tables">Handling Non-Numeric Columns in Pivot Tables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-values-and-performing-aggregation">Specifying values and performing aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seeing-break-down-using-columns">Seeing break down using columns</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions-to-exercise">Solutions to Exercise</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="data-manipulation">
<h1>Data Manipulation<a class="headerlink" href="#data-manipulation" title="Permalink to this heading">#</a></h1>
<p>We have learned how to select the data we want, we will need to learn how to manipulate it. Using aggregation methods to work with columns or rows is one of the most straightforward things we can perform.</p>
<p>All of these functions always <strong>return a number</strong> when applied to a row or column.</p>
<p>We can specify whether the function should be applied to</p>
<ul class="simple">
<li><p>the rows for each column using the <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> keyword on the function argument, or</p></li>
<li><p>the columns for each row using the <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> keyword on the function argument.</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>df.describe()</p></td>
<td><p>Returns a summary statistics of numerical column</p></td>
</tr>
<tr class="row-odd"><td><p>df.mean()</p></td>
<td><p>Returns the average of all columns in a dataset</p></td>
</tr>
<tr class="row-even"><td><p>df.corr()</p></td>
<td><p>Returns the correlation between columns in a DataFrame</p></td>
</tr>
<tr class="row-odd"><td><p>df.count()</p></td>
<td><p>Returns the number of non-null values in each DataFrame column</p></td>
</tr>
<tr class="row-even"><td><p>df.max()</p></td>
<td><p>Returns the highest value in each column</p></td>
</tr>
<tr class="row-odd"><td><p>df.min()</p></td>
<td><p>Returns the lowest value in each column</p></td>
</tr>
<tr class="row-even"><td><p>df.median()</p></td>
<td><p>Returns the median in each column</p></td>
</tr>
<tr class="row-odd"><td><p>df.std()</p></td>
<td><p>Returns the standard deviation in each column</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data&#39;</span><span class="p">,</span>
                   <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                   <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])</span>

<span class="nb">type</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span>                    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="nb">type</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;pd&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.843333</td>
      <td>3.054000</td>
      <td>3.758667</td>
      <td>1.198667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.828066</td>
      <td>0.433594</td>
      <td>1.764420</td>
      <td>0.763161</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.300000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.100000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.100000</td>
      <td>2.800000</td>
      <td>1.600000</td>
      <td>0.300000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.800000</td>
      <td>3.000000</td>
      <td>4.350000</td>
      <td>1.300000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.400000</td>
      <td>3.300000</td>
      <td>5.100000</td>
      <td>1.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.900000</td>
      <td>4.400000</td>
      <td>6.900000</td>
      <td>2.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You have the number of observations, their average value, standard deviation, minimum and maximum values, and certain percentiles for all numerical features” (25 percent, 50 percent, and 75 percent). This offers you a fair picture of how each feature is distributed.</p>
<p>The following command illustrate how to use the <code class="docutils literal notranslate"><span class="pre">max()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sepal_length               7.9
sepal_width                4.4
petal_length               6.9
petal_width                2.5
class           Iris-virginica
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can perform operations on all values in rows, columns, or a subset of both.</p>
<p>The following example shows how to find the standardized values of each column of the Iris dataset. We need to firstly drop the class column, which is a categorical variable using <code class="docutils literal notranslate"><span class="pre">drop()</span></code> function with <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>Recall that the Z-scores and standardized values (sometimes known as standard scores or normal deviates) are the same thing. When you take a data point and scale it by population data, you get a standardized value. It informs us how distant we are from the mean in terms of standard deviations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_drop</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">iris_drop</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iris_drop</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sepal_length    5.843333
sepal_width     3.054000
petal_length    3.758667
petal_width     1.198667
dtype: float64
sepal_length    0.828066
sepal_width     0.433594
petal_length    1.764420
petal_width     0.763161
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">z_score_standardization</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">series</span> <span class="o">-</span> <span class="n">series</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">series</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#iris_normalized = iris_drop</span>
<span class="c1">#for col in iris_normalized.columns:</span>
<span class="c1">#    iris_normalized[col] = z_score_standardization(iris_normalized[col])</span>

<span class="n">iris_normalized</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">iris_drop</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">iris_normalized</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">z_score_standardization</span><span class="p">(</span><span class="n">iris_drop</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    
<span class="n">iris_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris_normalized</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_normalized</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.897674</td>
      <td>1.028611</td>
      <td>-1.336794</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.139200</td>
      <td>-0.124540</td>
      <td>-1.336794</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.380727</td>
      <td>0.336720</td>
      <td>-1.393470</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.501490</td>
      <td>0.106090</td>
      <td>-1.280118</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.018437</td>
      <td>1.259242</td>
      <td>-1.336794</td>
      <td>-1.308593</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Alternatively, the following commands produce the same result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span><span class="p">(</span><span class="n">iris_normalized</span><span class="p">)</span>

<span class="n">iris_normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">iris_drop</span> <span class="o">-</span> <span class="n">iris_drop</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">iris_drop</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">iris_normalized</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.897674</td>
      <td>1.028611</td>
      <td>-1.336794</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.139200</td>
      <td>-0.124540</td>
      <td>-1.336794</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.380727</td>
      <td>0.336720</td>
      <td>-1.393470</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.501490</td>
      <td>0.106090</td>
      <td>-1.280118</td>
      <td>-1.308593</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.018437</td>
      <td>1.259242</td>
      <td>-1.336794</td>
      <td>-1.308593</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Alternatively, we can standardize a Pandas Column with Z-Score Scaling using scikit-learn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_drop</span><span class="p">)</span>

<span class="n">iris_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">iris_drop</span><span class="p">)</span>
<span class="n">iris_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris_drop</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iris_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     sepal_length  sepal_width  petal_length  petal_width
0       -0.900681     1.032057     -1.341272    -1.312977
1       -1.143017    -0.124958     -1.341272    -1.312977
2       -1.385353     0.337848     -1.398138    -1.312977
3       -1.506521     0.106445     -1.284407    -1.312977
4       -1.021849     1.263460     -1.341272    -1.312977
..            ...          ...           ...          ...
145      1.038005    -0.124958      0.819624     1.447956
146      0.553333    -1.281972      0.705893     0.922064
147      0.795669    -0.124958      0.819624     1.053537
148      0.432165     0.800654      0.933356     1.447956
149      0.068662    -0.124958      0.762759     0.790591

[150 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong>  scikit-learn uses np.std which by <strong>default is the population standard deviation</strong> (where the sum of squared deviations are divided by the number of observations), while the sample standard deviations (where the denominator is number of observations - 1) are used by pandas. This is a correction factor determined by the degrees of freedom in order to obtain an unbiased estimate of the population standard deviation (ddof). Numpy and scikit-learn calculations utilize ddof=0 by default, whereas pandas uses ddof=1 (docs).</p>
<p>As a result, the above results are different.</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/44220290/sklearn-standardscaler-result-different-to-manual-result">https://stackoverflow.com/questions/44220290/sklearn-standardscaler-result-different-to-manual-result</a></p>
<p>In the next example, we simply can apply any binary arithmetical operation (+,-,*,/) to an entire dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_drop</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26.01</td>
      <td>12.25</td>
      <td>1.96</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24.01</td>
      <td>9.00</td>
      <td>1.96</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22.09</td>
      <td>10.24</td>
      <td>1.69</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>3</th>
      <td>21.16</td>
      <td>9.61</td>
      <td>2.25</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25.00</td>
      <td>12.96</td>
      <td>1.96</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>44.89</td>
      <td>9.00</td>
      <td>27.04</td>
      <td>5.29</td>
    </tr>
    <tr>
      <th>146</th>
      <td>39.69</td>
      <td>6.25</td>
      <td>25.00</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>147</th>
      <td>42.25</td>
      <td>9.00</td>
      <td>27.04</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>148</th>
      <td>38.44</td>
      <td>11.56</td>
      <td>29.16</td>
      <td>5.29</td>
    </tr>
    <tr>
      <th>149</th>
      <td>34.81</td>
      <td>9.00</td>
      <td>26.01</td>
      <td>3.24</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div></div></div>
</div>
<p>Any function can be applied to a DataFrame or Series by passing its name as an argument to the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method. For example, in the following code, we use the NumPy library’s <code class="docutils literal notranslate"><span class="pre">floor</span></code> function to return the floor of the input, element-wise of each value in the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">iris_drop</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div></div></div>
</div>
<p>If we need to design a specific function to apply it, we can write an in-line function, commonly known as a <span class="math notranslate nohighlight">\(\lambda\)</span>-function. A <span class="math notranslate nohighlight">\(\lambda\)</span>-function is a function without a name.</p>
<p>It is only necessary to specify the parameters it receives, between the lambda keyword and the colon (:).</p>
<p>In the next example, only one parameter is needed, which will be the value of each element in the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_drop</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.707570</td>
      <td>0.544068</td>
      <td>0.146128</td>
      <td>-0.698970</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.690196</td>
      <td>0.477121</td>
      <td>0.146128</td>
      <td>-0.698970</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.672098</td>
      <td>0.505150</td>
      <td>0.113943</td>
      <td>-0.698970</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.662758</td>
      <td>0.491362</td>
      <td>0.176091</td>
      <td>-0.698970</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.698970</td>
      <td>0.556303</td>
      <td>0.146128</td>
      <td>-0.698970</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>0.826075</td>
      <td>0.477121</td>
      <td>0.716003</td>
      <td>0.361728</td>
    </tr>
    <tr>
      <th>146</th>
      <td>0.799341</td>
      <td>0.397940</td>
      <td>0.698970</td>
      <td>0.278754</td>
    </tr>
    <tr>
      <th>147</th>
      <td>0.812913</td>
      <td>0.477121</td>
      <td>0.716003</td>
      <td>0.301030</td>
    </tr>
    <tr>
      <th>148</th>
      <td>0.792392</td>
      <td>0.531479</td>
      <td>0.732394</td>
      <td>0.361728</td>
    </tr>
    <tr>
      <th>149</th>
      <td>0.770852</td>
      <td>0.477121</td>
      <td>0.707570</td>
      <td>0.255273</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div></div></div>
</div>
<section id="add-a-new-column-to-an-existing-pandas-dataframe">
<h2>Add A New Column To An Existing Pandas DataFrame<a class="headerlink" href="#add-a-new-column-to-an-existing-pandas-dataframe" title="Permalink to this heading">#</a></h2>
<p>Adding new values in our DataFrame is another simple manipulation technique. This can be done directly over a DataFrame with the assign operator (<code class="docutils literal notranslate"><span class="pre">=</span></code>).</p>
<p>For example, we can assign a Series to a selection of a column that does not exist to add a new column to a DataFrame.</p>
<p>You should be aware that previous values will be overridden if a column with the same name already exists.</p>
<p>In the following example, we create a new column entitled sepal_length_normalized by adding the standardized values of the sepal_length column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>class</th>
      <th>sepal_length_normalized</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-0.897674</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.139200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.380727</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.501490</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.018437</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>class</th>
      <th>sepal_length_normalized</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-0.900681</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.143017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.385353</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.506521</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.021849</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Alternatively, we can use <code class="docutils literal notranslate"><span class="pre">concat</span></code> function to add a Series (s) to a Pandas DataFrame (df) as a new column with an arguement <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>. The name of the new column can be set by using <code class="docutils literal notranslate"><span class="pre">Series.rename</span></code> as in the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">pd.concat((df,</span> <span class="pre">s.rename('CoolColumnName')),</span> <span class="pre">axis=1)</span></code></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/39047915/concat-series-onto-dataframe-with-column-name">https://stackoverflow.com/questions/39047915/concat-series-onto-dataframe-with-column-name</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">iris</span><span class="p">,</span> <span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;new_name&#39;</span><span class="p">)</span> <span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>class</th>
      <th>sepal_length_normalized</th>
      <th>new_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-0.900681</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.143017</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.385353</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.506521</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>-1.021849</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>1.038005</td>
      <td>5.7</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
      <td>0.553333</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>0.795669</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>0.432165</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>0.068662</td>
      <td>4.9</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 7 columns</p>
</div></div></div>
</div>
<p>We can now use the <code class="docutils literal notranslate"><span class="pre">drop</span></code> function to delete a column from the DataFrame; this removes the indicated rows if axis=0, or the indicated columns if axis=1.</p>
<p>All Pandas functions that change the contents of a DataFrame, such as the drop function, return a duplicate of the updated data rather than overwriting the DataFrame. As a result, the original DataFrame is preserved. Set the keyword <code class="docutils literal notranslate"><span class="pre">inplace</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> if you do not wish to maintain the old settings. This keyword is set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default, which means that a copy of the data is returned.</p>
<p>The following commands remove the column, namely ‘sepal_length_normalized’, we have just added to the Iris dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;, &#39;class&#39;,
       &#39;sepal_length_normalized&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;sepal_length_normalized&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   sepal_length  sepal_width  petal_length  petal_width        class
0           5.1          3.5           1.4          0.2  Iris-setosa
1           4.9          3.0           1.4          0.2  Iris-setosa
2           4.7          3.2           1.3          0.2  Iris-setosa
3           4.6          3.1           1.5          0.2  Iris-setosa
4           5.0          3.6           1.4          0.2  Iris-setosa
   sepal_length  sepal_width  petal_length  petal_width        class  \
0           5.1          3.5           1.4          0.2  Iris-setosa   
1           4.9          3.0           1.4          0.2  Iris-setosa   
2           4.7          3.2           1.3          0.2  Iris-setosa   
3           4.6          3.1           1.5          0.2  Iris-setosa   
4           5.0          3.6           1.4          0.2  Iris-setosa   

   sepal_length_normalized  
0                -0.900681  
1                -1.143017  
2                -1.385353  
3                -1.506521  
4                -1.021849  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;sepal_length_normalized&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   sepal_length  sepal_width  petal_length  petal_width        class
0           5.1          3.5           1.4          0.2  Iris-setosa
1           4.9          3.0           1.4          0.2  Iris-setosa
2           4.7          3.2           1.3          0.2  Iris-setosa
3           4.6          3.1           1.5          0.2  Iris-setosa
4           5.0          3.6           1.4          0.2  Iris-setosa
</pre></div>
</div>
</div>
</div>
</section>
<section id="appending-a-row-to-a-dataframe-and-specify-its-index-label">
<h2>Appending a row to a dataframe and specify its index label<a class="headerlink" href="#appending-a-row-to-a-dataframe-and-specify-its-index-label" title="Permalink to this heading">#</a></h2>
<p>In this section, we will learn how to add/remove new rows and remove missing values.  We will use the dataset, namely property_data.csv.</p>
<p>A general solution when appending a row to a dataframe and specify its index label is to create the row, transform the new row data into a pandas series, name it to the index you want to have and then append it to the data frame. Don’t forget to overwrite the original data frame with the one with appended row. The following commands produce the required result.</p>
<p>See <a class="reference external" href="https://stackoverflow.com/questions/16824607/pandas-appending-a-row-to-a-dataframe-and-specify-its-index-label">https://stackoverflow.com/questions/16824607/pandas-appending-a-row-to-a-dataframe-and-specify-its-index-label</a> for more details.</p>
<p>See also <a class="reference external" href="https://www.geeksforgeeks.org/python-pandas-dataframe-append/">https://www.geeksforgeeks.org/python-pandas-dataframe-append/</a> and
<a class="reference external" href="https://thispointer.com/python-pandas-how-to-add-rows-in-a-dataframe-using-dataframe-append-loc-iloc/#3">https://thispointer.com/python-pandas-how-to-add-rows-in-a-dataframe-using-dataframe-append-loc-iloc/#3</a> .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#filepath = &#39;/Users/Kaemyuijang/SCMA248/Data/property_data.csv&#39;</span>

<span class="c1">#df = pd.read_csv(filepath, index_col = 0)</span>
<span class="c1">#df.head()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/property_data.csv&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
    </tr>
    <tr>
      <th>PID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10101.0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>10102.0</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
    </tr>
    <tr>
      <th>10103.0</th>
      <td>NaN</td>
      <td>Silom</td>
      <td>N</td>
      <td>NaN</td>
      <td>1</td>
      <td>850</td>
    </tr>
    <tr>
      <th>10104.0</th>
      <td>201.0</td>
      <td>Sukhumvit</td>
      <td>12</td>
      <td>1</td>
      <td>NaN</td>
      <td>700</td>
    </tr>
    <tr>
      <th>NaN</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Float64Index([10101.0, 10102.0, 10103.0, 10104.0, nan, 10106.0, 10107.0,
              10108.0, 10109.0],
             dtype=&#39;float64&#39;, name=&#39;PID&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#new_observation = {&#39;ST_NUM&#39;: 555 , &#39;OWN_OCCUPIED&#39;: &#39;Y&#39;, &#39;NUM_BEDROOMS&#39;: 2,&#39;NUM_BATH&#39;: 1,&#39;SQ_FT&#39;: 200}</span>

<span class="n">new_observation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">:</span> <span class="mi">555</span> <span class="p">,</span> <span class="s1">&#39;OWN_OCCUPIED&#39;</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;NUM_BEDROOMS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="s1">&#39;NUM_BATH&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;SQ_FT&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">},</span> <span class="n">name</span> <span class="o">=</span> <span class="mf">10110.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_observation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ST_NUM          555
OWN_OCCUPIED      Y
NUM_BEDROOMS      2
NUM_BATH          1
SQ_FT           200
Name: 10110.0, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">new_observation</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead</span>

<span class="c1">#df.append(new_observation)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong> In case that, we do not define a name for our pandas series, i.e. we simply define <code class="docutils literal notranslate"><span class="pre">next_observation</span> <span class="pre">=</span> <span class="pre">pd.Series({'ST_NUM':</span> <span class="pre">999</span> <span class="pre">,</span> <span class="pre">'OWN_OCCUPIED':</span> <span class="pre">'Y',</span> <span class="pre">'NUM_BEDROOMS':</span> <span class="pre">2,'NUM_BATH':</span> <span class="pre">1,'SQ_FT':</span> <span class="pre">200})</span></code> without the flag <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">10110.0</span></code> as an argument. We must set the <code class="docutils literal notranslate"><span class="pre">ignore_index</span></code> flag in the append method to <code class="docutils literal notranslate"><span class="pre">True</span></code>, otherwise the commands will produce an error as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">next_observation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">:</span> <span class="mi">999</span> <span class="p">,</span> <span class="s1">&#39;OWN_OCCUPIED&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;NUM_BEDROOMS&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span><span class="s1">&#39;NUM_BATH&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;SQ_FT&#39;</span><span class="p">:</span> <span class="mi">3500</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">next_observation</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ST_NUM           999
OWN_OCCUPIED       N
NUM_BEDROOMS       5
NUM_BATH           4
SQ_FT           3500
dtype: object
              ST_NUM    ST_NAME OWN_OCCUPIED NUM_BEDROOMS NUM_BATH SQ_FT  \
10101.0        104.0   Khao San            Y            3        1  1000   
10102.0        197.0      Silom            N            3      1.5    --   
10103.0          NaN      Silom            N          NaN        1   850   
10104.0        201.0  Sukhumvit           12            1      NaN   700   
NaN            203.0  Sukhumvit            Y            3        2  1600   
10106.0        207.0  Sukhumvit            Y          NaN        1   800   
10107.0          NaN   Thonglor          NaN            2   HURLEY   950   
10108.0        213.0     Rama 1            Y           --        1   NaN   
10109.0        215.0     Rama 1            Y           na        2  1800   
ST_NUM           NaN        NaN          NaN          NaN      NaN   NaN   
OWN_OCCUPIED     NaN        NaN          NaN          NaN      NaN   NaN   
NUM_BEDROOMS     NaN        NaN          NaN          NaN      NaN   NaN   
NUM_BATH         NaN        NaN          NaN          NaN      NaN   NaN   
SQ_FT            NaN        NaN          NaN          NaN      NaN   NaN   

             10110.0  
10101.0          NaN  
10102.0          NaN  
10103.0          NaN  
10104.0          NaN  
NaN              NaN  
10106.0          NaN  
10107.0          NaN  
10108.0          NaN  
10109.0          NaN  
ST_NUM           555  
OWN_OCCUPIED       Y  
NUM_BEDROOMS       2  
NUM_BATH           1  
SQ_FT            200  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Without setting the ignore_index flag in the append method to True, this produces an eror.</span>

<span class="c1"># df.append(next_observation)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting the ignore_index flag in the append method to True</span>

<span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_observation</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/1s/4ndng0l11_s0dxtqj995xwr40000gn/T/ipykernel_1129/3902330227.py:3: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  df.append(next_observation,ignore_index=True)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
      <th>10110.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>Silom</td>
      <td>N</td>
      <td>NaN</td>
      <td>1</td>
      <td>850</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201.0</td>
      <td>Sukhumvit</td>
      <td>12</td>
      <td>1</td>
      <td>NaN</td>
      <td>700</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>207.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>NaN</td>
      <td>1</td>
      <td>800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>Thonglor</td>
      <td>NaN</td>
      <td>2</td>
      <td>HURLEY</td>
      <td>950</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>213.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>--</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>215.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>na</td>
      <td>2</td>
      <td>1800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>555</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200</td>
    </tr>
    <tr>
      <th>14</th>
      <td>999.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>5</td>
      <td>4</td>
      <td>3500</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Note</strong> The resulting (new) DataFrame’s index is not same as original dataframe because ignore_index is passed as True in the <code class="docutils literal notranslate"><span class="pre">append()</span></code> function.</p>
<p>The next complete example illustrates how to add multiple rows to dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_observation</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">next_observation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ST_NUM          555
OWN_OCCUPIED      Y
NUM_BEDROOMS      2
NUM_BATH          1
SQ_FT           200
Name: 10110.0, dtype: object
ST_NUM           999
OWN_OCCUPIED       N
NUM_BEDROOMS       5
NUM_BATH           4
SQ_FT           3500
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listOfSeries</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_observation</span><span class="p">,</span><span class="n">next_observation</span><span class="p">]</span>

<span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listOfSeries</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/1s/4ndng0l11_s0dxtqj995xwr40000gn/T/ipykernel_1129/2982668531.py:3: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  new_df = df.append(listOfSeries, ignore_index = True)
</pre></div>
</div>
</div>
</div>
<p>Finally, to remove the row(s), we can apply the drop method once more. Now we must set the axis to 0 and specify the row index we want to remove.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
      <th>10110.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>Silom</td>
      <td>N</td>
      <td>NaN</td>
      <td>1</td>
      <td>850</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201.0</td>
      <td>Sukhumvit</td>
      <td>12</td>
      <td>1</td>
      <td>NaN</td>
      <td>700</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>207.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>NaN</td>
      <td>1</td>
      <td>800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>Thonglor</td>
      <td>NaN</td>
      <td>2</td>
      <td>HURLEY</td>
      <td>950</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>213.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>--</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>215.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>na</td>
      <td>2</td>
      <td>1800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200</td>
    </tr>
    <tr>
      <th>14</th>
      <td>555.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>2</td>
      <td>1</td>
      <td>200</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>999.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>5</td>
      <td>4</td>
      <td>3500</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>By applying the <code class="docutils literal notranslate"><span class="pre">drop()</span></code> function to the result of the <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> method, missing values can be removed. This has the same effect as filtering the NaN values, as explained above, but instead of returning a view, a duplicate of the DataFrame minus the NaN values is returned.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

<span class="c1"># Altenatively, one can obtain the index </span>
<span class="n">new_index</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">new_index</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ST_NUM    ST_NAME OWN_OCCUPIED NUM_BEDROOMS NUM_BATH SQ_FT 10110.0
0    104.0   Khao San            Y            3        1  1000     NaN
1    197.0      Silom            N            3      1.5    --     NaN
3    201.0  Sukhumvit           12            1      NaN   700     NaN
4    203.0  Sukhumvit            Y            3        2  1600     NaN
5    207.0  Sukhumvit            Y          NaN        1   800     NaN
7    213.0     Rama 1            Y           --        1   NaN     NaN
8    215.0     Rama 1            Y           na        2  1800     NaN
14   555.0        NaN            Y            2        1   200     NaN
15   999.0        NaN            N            5        4  3500     NaN
    ST_NUM    ST_NAME OWN_OCCUPIED NUM_BEDROOMS NUM_BATH SQ_FT 10110.0
0    104.0   Khao San            Y            3        1  1000     NaN
1    197.0      Silom            N            3      1.5    --     NaN
3    201.0  Sukhumvit           12            1      NaN   700     NaN
4    203.0  Sukhumvit            Y            3        2  1600     NaN
5    207.0  Sukhumvit            Y          NaN        1   800     NaN
7    213.0     Rama 1            Y           --        1   NaN     NaN
8    215.0     Rama 1            Y           na        2  1800     NaN
14   555.0        NaN            Y            2        1   200     NaN
15   999.0        NaN            N            5        4  3500     NaN
</pre></div>
</div>
</div>
</div>
<p>Instead of using the generic drop function, we can use the particular <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> function to remove NaN values. We must set the <code class="docutils literal notranslate"><span class="pre">how</span></code> keyword to <code class="docutils literal notranslate"><span class="pre">any</span></code> if we wish to delete any record that includes a NaN value. We can use the <code class="docutils literal notranslate"><span class="pre">subset</span></code> keyword to limit it to a specific subset of columns. The effect will be the same as if we used the drop function, as shown below:</p>
<p><strong>Note</strong> The parameter <code class="docutils literal notranslate"><span class="pre">how{‘any’,</span> <span class="pre">‘all’}</span></code>, default ‘any’ determine if row or column is removed from DataFrame, when we have at least one NA or all NA.</p>
<ul class="simple">
<li><p>‘any’ : If any NA values are present, drop that row or column.</p></li>
<li><p>‘all’ : If all values are NA, drop that row or column.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
      <th>10110.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10101.0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10102.0</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10104.0</th>
      <td>201.0</td>
      <td>Sukhumvit</td>
      <td>12</td>
      <td>1</td>
      <td>NaN</td>
      <td>700</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NaN</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10106.0</th>
      <td>207.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>NaN</td>
      <td>1</td>
      <td>800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10108.0</th>
      <td>213.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>--</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10109.0</th>
      <td>215.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>na</td>
      <td>2</td>
      <td>1800</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting subset keyword with a subset of columns</span>

<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">,</span><span class="s1">&#39;NUM_BATH&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
      <th>10110.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10101.0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10102.0</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NaN</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10106.0</th>
      <td>207.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>NaN</td>
      <td>1</td>
      <td>800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10108.0</th>
      <td>213.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>--</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10109.0</th>
      <td>215.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>na</td>
      <td>2</td>
      <td>1800</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we wish to fill the rows containing NaN with another value instead of removing them, we may use the <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> method and specify the value to use. If we only want to fill certain columns, we must pass a dictionary as an argument to the <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> function, with the names of the columns as the key and the character to use for filling as the value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
      <th>10110.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10101.0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10102.0</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10103.0</th>
      <td>0.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>NaN</td>
      <td>1</td>
      <td>850</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10104.0</th>
      <td>201.0</td>
      <td>Sukhumvit</td>
      <td>12</td>
      <td>1</td>
      <td>NaN</td>
      <td>700</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NaN</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10106.0</th>
      <td>207.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>NaN</td>
      <td>1</td>
      <td>800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10107.0</th>
      <td>0.0</td>
      <td>Thonglor</td>
      <td>NaN</td>
      <td>2</td>
      <td>HURLEY</td>
      <td>950</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10108.0</th>
      <td>213.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>--</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10109.0</th>
      <td>215.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>na</td>
      <td>2</td>
      <td>1800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ST_NUM</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>555</td>
    </tr>
    <tr>
      <th>OWN_OCCUPIED</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>NUM_BEDROOMS</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>NUM_BATH</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>SQ_FT</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST_NUM&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;NUM_BEDROOMS&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST_NUM</th>
      <th>ST_NAME</th>
      <th>OWN_OCCUPIED</th>
      <th>NUM_BEDROOMS</th>
      <th>NUM_BATH</th>
      <th>SQ_FT</th>
      <th>10110.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10101.0</th>
      <td>104.0</td>
      <td>Khao San</td>
      <td>Y</td>
      <td>3</td>
      <td>1</td>
      <td>1000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10102.0</th>
      <td>197.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>3</td>
      <td>1.5</td>
      <td>--</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10103.0</th>
      <td>-1.0</td>
      <td>Silom</td>
      <td>N</td>
      <td>-1</td>
      <td>1</td>
      <td>850</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10104.0</th>
      <td>201.0</td>
      <td>Sukhumvit</td>
      <td>12</td>
      <td>1</td>
      <td>NaN</td>
      <td>700</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NaN</th>
      <td>203.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>3</td>
      <td>2</td>
      <td>1600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10106.0</th>
      <td>207.0</td>
      <td>Sukhumvit</td>
      <td>Y</td>
      <td>-1</td>
      <td>1</td>
      <td>800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10107.0</th>
      <td>-1.0</td>
      <td>Thonglor</td>
      <td>NaN</td>
      <td>2</td>
      <td>HURLEY</td>
      <td>950</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10108.0</th>
      <td>213.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>--</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10109.0</th>
      <td>215.0</td>
      <td>Rama 1</td>
      <td>Y</td>
      <td>na</td>
      <td>2</td>
      <td>1800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ST_NUM</th>
      <td>-1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>555</td>
    </tr>
    <tr>
      <th>OWN_OCCUPIED</th>
      <td>-1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>NUM_BEDROOMS</th>
      <td>-1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>NUM_BATH</th>
      <td>-1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>SQ_FT</th>
      <td>-1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sorting">
<h2>Sorting<a class="headerlink" href="#sorting" title="Permalink to this heading">#</a></h2>
<p>Sorting by columns is another important feature we will need while examining at our data. Using the sort method, we can sort a DataFrame by any column. We only need to execute the following commands to see the first five rows of data sorted in descending order (i.e., from the largest to the lowest values) and using the Value column:</p>
<p>Here we will work with the Iris dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;, &#39;class&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>7.9</td>
      <td>3.8</td>
      <td>6.4</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>135</th>
      <td>7.7</td>
      <td>3.0</td>
      <td>6.1</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>122</th>
      <td>7.7</td>
      <td>2.8</td>
      <td>6.7</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>117</th>
      <td>7.7</td>
      <td>3.8</td>
      <td>6.7</td>
      <td>2.2</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>118</th>
      <td>7.7</td>
      <td>2.6</td>
      <td>6.9</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>4.5</td>
      <td>2.3</td>
      <td>1.3</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>42</th>
      <td>4.4</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>38</th>
      <td>4.4</td>
      <td>3.0</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.4</td>
      <td>2.9</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4.3</td>
      <td>3.0</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<p>The following command sorts the sepal_lenghth column followed by the petal_length column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span><span class="s1">&#39;petal_length&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>7.9</td>
      <td>3.8</td>
      <td>6.4</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>118</th>
      <td>7.7</td>
      <td>2.6</td>
      <td>6.9</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>117</th>
      <td>7.7</td>
      <td>3.8</td>
      <td>6.7</td>
      <td>2.2</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>122</th>
      <td>7.7</td>
      <td>2.8</td>
      <td>6.7</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>135</th>
      <td>7.7</td>
      <td>3.0</td>
      <td>6.1</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>4.5</td>
      <td>2.3</td>
      <td>1.3</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.4</td>
      <td>2.9</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>38</th>
      <td>4.4</td>
      <td>3.0</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>42</th>
      <td>4.4</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4.3</td>
      <td>3.0</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<p><strong>Note</strong></p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">inplace</span></code> keyword indicates that the DataFrame will be overwritten, hence no new DataFrame will be returned.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">ascending</span> <span class="pre">=</span> <span class="pre">True</span></code> is used instead of <code class="docutils literal notranslate"><span class="pre">ascending</span> <span class="pre">=</span> <span class="pre">False</span></code>, the values are sorted in ascending order (i.e., from the smallest to the largest values).</p></li>
<li><p>If we wish to restore the original order, we can use the <code class="docutils literal notranslate"><span class="pre">sort_index</span></code> method and sort by an index.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># restore the original order</span>

<span class="n">iris</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing sales dataset for the next section</span>

<span class="c1"># filepath = &#39;/Users/Kaemyuijang/SCMA248/Data/SalesData.csv&#39;</span>
<span class="c1"># filepath = &#39;/Users/Kaemyui/Documents/SCMA248/Data/SalesData.csv&#39;</span>

<span class="c1"># pd.read_csv(filepath, header = None, skiprows = 1, names = [&#39;Trans_no&#39;,&#39;Name&#39;,&#39;Date&#39;,&#39;Product&#39;,&#39;Units&#39;,&#39;Dollars&#39;,&#39;Location&#39;])</span>

<span class="c1"># header = 0 means that the first row to use as the column names</span>
<span class="c1"># sales = pd.read_csv(filepath, header = 0,  index_col = 0)</span>


<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/SalesData.csv&#39;</span>
<span class="n">sales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># https://stackoverflow.com/questions/25015711/time-data-does-not-match-format</span>
<span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span>

<span class="n">sales</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Date</th>
      <th>Product</th>
      <th>Units</th>
      <th>Dollars</th>
      <th>Location</th>
    </tr>
    <tr>
      <th>Trans_Number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Betsy</td>
      <td>2004-04-01</td>
      <td>lip gloss</td>
      <td>45</td>
      <td>137.20</td>
      <td>south</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hallagan</td>
      <td>2004-03-10</td>
      <td>foundation</td>
      <td>50</td>
      <td>152.01</td>
      <td>midwest</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ashley</td>
      <td>2005-02-25</td>
      <td>lipstick</td>
      <td>9</td>
      <td>28.72</td>
      <td>midwest</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hallagan</td>
      <td>2006-05-22</td>
      <td>lip gloss</td>
      <td>55</td>
      <td>167.08</td>
      <td>west</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Zaret</td>
      <td>2004-06-17</td>
      <td>lip gloss</td>
      <td>43</td>
      <td>130.60</td>
      <td>midwest</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="grouping-data">
<h2>Grouping Data<a class="headerlink" href="#grouping-data" title="Permalink to this heading">#</a></h2>
<p>Another useful method for inspecting data is to group it according to certain criteria. For the sales dataset, it would be useful to categorize all of the data by location, independent of the year. The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> function in Pandas allows us to accomplish just that. This function returns a special grouped DataFrame as a result. As a result, an aggregate function must be used to create a suitable DataFrame. As a result, <strong>all values in the same group will be subjected to this function</strong>.</p>
<p>For instance, in our scenario, we can get a DataFrame that shows the number (count) of the transactions for each location across all years by grouping by location and using the count function as the aggregation technique for each group. As a consequence, a DataFrame with locations as indexes and counting values of transactions as the column would be created:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)))</span>

<span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.groupby.generic.DataFrameGroupBy&#39;&gt;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>456</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>424</td>
    </tr>
    <tr>
      <th>south</th>
      <td>521</td>
    </tr>
    <tr>
      <th>west</th>
      <td>490</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a DataFrame with locations as indexes and mean of sales income  as </span>
<span class="c1"># the column would be created</span>

<span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>125.815965</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>129.258113</td>
    </tr>
    <tr>
      <th>south</th>
      <td>123.409616</td>
    </tr>
    <tr>
      <th>west</th>
      <td>129.467082</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Dollars&#39;</span><span class="p">,</span><span class="s1">&#39;Units&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
      <th>Units</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>125.815965</td>
      <td>41.267544</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>129.258113</td>
      <td>42.417453</td>
    </tr>
    <tr>
      <th>south</th>
      <td>123.409616</td>
      <td>40.466411</td>
    </tr>
    <tr>
      <th>west</th>
      <td>129.467082</td>
      <td>42.491837</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="introduction-to-pivot-tables">
<h2>Introduction to Pivot Tables<a class="headerlink" href="#introduction-to-pivot-tables" title="Permalink to this heading">#</a></h2>
<p>In data analysis, we often encounter datasets with multiple dimensions and variables. These datasets may not always be structured in a way that facilitates easy analysis or interpretation. Pivot tables offer a powerful tool for rearranging and summarizing data to extract meaningful insights.</p>
<p><strong>Why Use Pivot Tables?</strong></p>
<ol class="arabic simple">
<li><p><strong>Improved Data Organization:</strong> Pivot tables allow us to rearrange our data by redistributing indexes and columns, providing a clearer and more organized structure.</p></li>
<li><p><strong>Enhanced Data Processing:</strong> By restructuring our data with pivot tables, we can improve data processing performance, making it easier to analyze and interpret large datasets.</p></li>
<li><p><strong>Efficient Summarization:</strong> Pivot tables enable us to summarize and aggregate data efficiently, providing valuable summaries and statistics for analysis.</p></li>
</ol>
<p><strong>When to Use Pivot Tables</strong></p>
<ul class="simple">
<li><p><strong>Exploratory Data Analysis (EDA):</strong> Pivot tables are invaluable during the initial stages of data exploration, helping to identify trends, patterns, and relationships within the dataset.</p></li>
<li><p><strong>Reporting and Visualization:</strong> Pivot tables are commonly used for creating summary reports and visualizations, making complex datasets more accessible and understandable.</p></li>
</ul>
<p><strong>Using the <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> Function</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function in Python’s pandas library allows us to create pivot tables easily. We can define which columns will become the new indexes, values, and columns, providing flexibility in how we structure our data for analysis.</p>
<section id="simplest-pivot-table">
<h3>Simplest Pivot table<a class="headerlink" href="#simplest-pivot-table" title="Permalink to this heading">#</a></h3>
<p>An <code class="docutils literal notranslate"><span class="pre">index</span></code> is required even for the smallest pivot table. Let us utilize the location as our index in this case. It uses the <code class="docutils literal notranslate"><span class="pre">'mean'</span></code> aggregation function on all available numerical columns by default.</p>
<p>When creating pivot tables, it’s essential to ensure that all columns included in the aggregation are numeric. However, encountering non-numeric columns may lead to warnings or errors during pivot table creation, prompting the need to handle them appropriately.</p>
</section>
<section id="handling-non-numeric-columns-in-pivot-tables">
<h3>Handling Non-Numeric Columns in Pivot Tables<a class="headerlink" href="#handling-non-numeric-columns-in-pivot-tables" title="Permalink to this heading">#</a></h3>
<p>When encountering a warning about a column that cannot be aggregated in a pivot table due to non-numeric values, follow these steps to address the issue (try running this command:  <code class="docutils literal notranslate"><span class="pre">sales.pivot_table(index='Location')</span></code>):</p>
<ol class="arabic">
<li><p><strong>Identify Non-Numeric Columns</strong>: Review your dataset to identify columns containing non-numeric data that are included in the pivot table.</p></li>
<li><p><strong>Select Numeric Columns</strong>: Create a subset of the dataset containing only the numeric columns that you want to include in the pivot table. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sales_numeric</span> <span class="o">=</span> <span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span> <span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</li>
<li><p><strong>Create Pivot Table with Aggregation</strong>: Use the selected numeric columns to create the pivot table, specifying how they should be aggregated. You can use aggregation functions like <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, etc., depending on your requirements. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pivot_table</span> <span class="o">=</span> <span class="n">sales_numeric</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Review Results</strong>: Verify that the pivot table is created without errors and provides meaningful insights based on the selected numeric columns.</p></li>
</ol>
<p>By following these steps, you ensure that non-numeric columns are appropriately handled in pivot tables, preventing errors and ensuring accurate aggregation of data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sales.pivot_table(index=&#39;Location&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                                     <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             Dollars      Units
Location                       
east      125.815965  41.267544
midwest   129.258113  42.417453
south     123.409616  40.466411
west      129.467082  42.491837
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong> The <code class="docutils literal notranslate"><span class="pre">index.names</span></code> attribute returns the names of the levels in the index of a pandas DataFrame. In multi-level indices, it provides a list of names for each level. For example, if you have a DataFrame with a multi-level index, <code class="docutils literal notranslate"><span class="pre">out.index.names</span></code> would return a list containing the names of each level of the index. If the index has no names, it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([&#39;Location&#39;])
</pre></div>
</div>
</div>
</div>
<p>To display multiple indexes, we can pass a list to index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#sales.pivot_table(index=[&#39;Location&#39;,&#39;Product&#39;])</span>

<span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span> 
       <span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Product&#39;</span><span class="p">],</span> 
                               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Dollars</th>
      <th>Units</th>
    </tr>
    <tr>
      <th>Location</th>
      <th>Product</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">east</th>
      <th>eye liner</th>
      <td>132.521304</td>
      <td>43.513043</td>
    </tr>
    <tr>
      <th>foundation</th>
      <td>120.755248</td>
      <td>39.584158</td>
    </tr>
    <tr>
      <th>lip gloss</th>
      <td>119.001134</td>
      <td>38.989691</td>
    </tr>
    <tr>
      <th>lipstick</th>
      <td>136.096279</td>
      <td>44.697674</td>
    </tr>
    <tr>
      <th>mascara</th>
      <td>125.406000</td>
      <td>41.120000</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">midwest</th>
      <th>eye liner</th>
      <td>127.295980</td>
      <td>41.745098</td>
    </tr>
    <tr>
      <th>foundation</th>
      <td>139.133333</td>
      <td>45.712644</td>
    </tr>
    <tr>
      <th>lip gloss</th>
      <td>130.765316</td>
      <td>42.936709</td>
    </tr>
    <tr>
      <th>lipstick</th>
      <td>136.465472</td>
      <td>44.811321</td>
    </tr>
    <tr>
      <th>mascara</th>
      <td>117.995340</td>
      <td>38.669903</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">south</th>
      <th>eye liner</th>
      <td>121.481947</td>
      <td>39.831858</td>
    </tr>
    <tr>
      <th>foundation</th>
      <td>121.983852</td>
      <td>39.977778</td>
    </tr>
    <tr>
      <th>lip gloss</th>
      <td>121.492632</td>
      <td>39.824561</td>
    </tr>
    <tr>
      <th>lipstick</th>
      <td>115.709273</td>
      <td>37.909091</td>
    </tr>
    <tr>
      <th>mascara</th>
      <td>133.528462</td>
      <td>43.846154</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">west</th>
      <th>eye liner</th>
      <td>136.215000</td>
      <td>44.735849</td>
    </tr>
    <tr>
      <th>foundation</th>
      <td>137.521553</td>
      <td>45.194175</td>
    </tr>
    <tr>
      <th>lip gloss</th>
      <td>115.428197</td>
      <td>37.795082</td>
    </tr>
    <tr>
      <th>lipstick</th>
      <td>132.699643</td>
      <td>43.589286</td>
    </tr>
    <tr>
      <th>mascara</th>
      <td>129.339223</td>
      <td>42.446602</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span> 
       <span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Product&#39;</span><span class="p">],</span> 
                               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">out</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([&#39;Location&#39;, &#39;Product&#39;])
</pre></div>
</div>
</div>
</div>
<p>On the pivot table, the values to index are the keys to group by. To achieve a different visual representation, you can change the order of the values. For example, we can look at average values by grouping the region with the product category.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sales.pivot_table(index=[&#39;Product&#39;,&#39;Location&#39;])</span>

<span class="n">sales</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span> 
       <span class="s1">&#39;Dollars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Location&#39;</span><span class="p">],</span> 
                               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Dollars</th>
      <th>Units</th>
    </tr>
    <tr>
      <th>Product</th>
      <th>Location</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">eye liner</th>
      <th>east</th>
      <td>132.521304</td>
      <td>43.513043</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>127.295980</td>
      <td>41.745098</td>
    </tr>
    <tr>
      <th>south</th>
      <td>121.481947</td>
      <td>39.831858</td>
    </tr>
    <tr>
      <th>west</th>
      <td>136.215000</td>
      <td>44.735849</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">foundation</th>
      <th>east</th>
      <td>120.755248</td>
      <td>39.584158</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>139.133333</td>
      <td>45.712644</td>
    </tr>
    <tr>
      <th>south</th>
      <td>121.983852</td>
      <td>39.977778</td>
    </tr>
    <tr>
      <th>west</th>
      <td>137.521553</td>
      <td>45.194175</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">lip gloss</th>
      <th>east</th>
      <td>119.001134</td>
      <td>38.989691</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>130.765316</td>
      <td>42.936709</td>
    </tr>
    <tr>
      <th>south</th>
      <td>121.492632</td>
      <td>39.824561</td>
    </tr>
    <tr>
      <th>west</th>
      <td>115.428197</td>
      <td>37.795082</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">lipstick</th>
      <th>east</th>
      <td>136.096279</td>
      <td>44.697674</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>136.465472</td>
      <td>44.811321</td>
    </tr>
    <tr>
      <th>south</th>
      <td>115.709273</td>
      <td>37.909091</td>
    </tr>
    <tr>
      <th>west</th>
      <td>132.699643</td>
      <td>43.589286</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">mascara</th>
      <th>east</th>
      <td>125.406000</td>
      <td>41.120000</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>117.995340</td>
      <td>38.669903</td>
    </tr>
    <tr>
      <th>south</th>
      <td>133.528462</td>
      <td>43.846154</td>
    </tr>
    <tr>
      <th>west</th>
      <td>129.339223</td>
      <td>42.446602</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="specifying-values-and-performing-aggregation">
<h3>Specifying values and performing aggregation<a class="headerlink" href="#specifying-values-and-performing-aggregation" title="Permalink to this heading">#</a></h3>
<p>The mean aggregation function is applied to the specified numeric columns by default, along with the index column(s), and the result is returned. Use the <code class="docutils literal notranslate"><span class="pre">values</span></code> argument to explicitly specify the numeric columns we are interested in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                         <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>125.815965</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>129.258113</td>
    </tr>
    <tr>
      <th>south</th>
      <td>123.409616</td>
    </tr>
    <tr>
      <th>west</th>
      <td>129.467082</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can specify a valid string function to <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> to perform an aggregation other than mean, for example, a sum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                         <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>57372.08</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>54805.44</td>
    </tr>
    <tr>
      <th>south</th>
      <td>64296.41</td>
    </tr>
    <tr>
      <th>west</th>
      <td>63438.87</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> can be a dict, and below is the dict equivalent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Dollars&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>57372.08</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>54805.44</td>
    </tr>
    <tr>
      <th>south</th>
      <td>64296.41</td>
    </tr>
    <tr>
      <th>west</th>
      <td>63438.87</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> can be a list of functions, and below is an example to display the <code class="docutils literal notranslate"><span class="pre">sum</span></code> and <code class="docutils literal notranslate"><span class="pre">count</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>sum</th>
      <th>count</th>
    </tr>
    <tr>
      <th></th>
      <th>Dollars</th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>57372.08</td>
      <td>456</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>54805.44</td>
      <td>424</td>
    </tr>
    <tr>
      <th>south</th>
      <td>64296.41</td>
      <td>521</td>
    </tr>
    <tr>
      <th>west</th>
      <td>63438.87</td>
      <td>490</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">])</span>

<span class="n">out</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(  &#39;sum&#39;, &#39;Dollars&#39;),
            (&#39;count&#39;, &#39;Dollars&#39;)],
           )
</pre></div>
</div>
</div>
</div>
</section>
<section id="seeing-break-down-using-columns">
<h3>Seeing break down using columns<a class="headerlink" href="#seeing-break-down-using-columns" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter in the pivot_table function provides a powerful way to further break down and analyze data by additional categorical variables. When specifying a column or list of columns, the pivot table will create separate columns for each unique value in the specified column(s), effectively creating a multi-dimensional view of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                 <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Dollars</th>
    </tr>
    <tr>
      <th>Product</th>
      <th>eye liner</th>
      <th>foundation</th>
      <th>lip gloss</th>
      <th>lipstick</th>
      <th>mascara</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>15239.95</td>
      <td>12196.28</td>
      <td>11543.11</td>
      <td>5852.14</td>
      <td>12540.60</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>12984.19</td>
      <td>12104.60</td>
      <td>10330.46</td>
      <td>7232.67</td>
      <td>12153.52</td>
    </tr>
    <tr>
      <th>south</th>
      <td>13727.46</td>
      <td>16467.82</td>
      <td>13850.16</td>
      <td>6364.01</td>
      <td>13886.96</td>
    </tr>
    <tr>
      <th>west</th>
      <td>14438.79</td>
      <td>14164.72</td>
      <td>14082.24</td>
      <td>7431.18</td>
      <td>13321.94</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Note</strong>  If there are missing values and we want to replace them, we could use <code class="docutils literal notranslate"><span class="pre">fill_value</span></code> argument, for example, to set <code class="docutils literal notranslate"><span class="pre">NaN</span></code> to a specific value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                 <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Product&#39;</span><span class="p">,</span>
                 <span class="n">fill_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Dollars</th>
    </tr>
    <tr>
      <th>Product</th>
      <th>eye liner</th>
      <th>foundation</th>
      <th>lip gloss</th>
      <th>lipstick</th>
      <th>mascara</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>east</th>
      <td>15239.95</td>
      <td>12196.28</td>
      <td>11543.11</td>
      <td>5852.14</td>
      <td>12540.60</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>12984.19</td>
      <td>12104.60</td>
      <td>10330.46</td>
      <td>7232.67</td>
      <td>12153.52</td>
    </tr>
    <tr>
      <th>south</th>
      <td>13727.46</td>
      <td>16467.82</td>
      <td>13850.16</td>
      <td>6364.01</td>
      <td>13886.96</td>
    </tr>
    <tr>
      <th>west</th>
      <td>14438.79</td>
      <td>14164.72</td>
      <td>14082.24</td>
      <td>7431.18</td>
      <td>13321.94</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h2>
<p>Apply <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> (in new worksheets) to answer the following questions.</p>
<ol class="arabic simple">
<li><p>The number of sales transactions for each salesperson.</p></li>
<li><p>Calculate the total revenue for each given product sold by each salesperson.</p></li>
<li><p>Determine the total revenue generated by each salesperson, further broken down by location.</p></li>
<li><p>Compute the total revenue for each salesperson within a specified year..</p></li>
</ol>
</section>
<section id="solutions-to-exercise">
<h2>Solutions to Exercise<a class="headerlink" href="#solutions-to-exercise" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>The number of sales transactions for each salesperson.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Name&#39;, &#39;Date&#39;, &#39;Product&#39;, &#39;Units&#39;, &#39;Dollars&#39;, &#39;Location&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span>
                  <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ashley</th>
      <td>197</td>
    </tr>
    <tr>
      <th>Betsy</th>
      <td>217</td>
    </tr>
    <tr>
      <th>Cici</th>
      <td>230</td>
    </tr>
    <tr>
      <th>Colleen</th>
      <td>206</td>
    </tr>
    <tr>
      <th>Cristina</th>
      <td>207</td>
    </tr>
    <tr>
      <th>Emilee</th>
      <td>203</td>
    </tr>
    <tr>
      <th>Hallagan</th>
      <td>200</td>
    </tr>
    <tr>
      <th>Jen</th>
      <td>217</td>
    </tr>
    <tr>
      <th>Zaret</th>
      <td>214</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span>
                  <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Dollars&#39;</span><span class="p">],</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;Dollars&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ashley</th>
      <td>197</td>
    </tr>
    <tr>
      <th>Hallagan</th>
      <td>200</td>
    </tr>
    <tr>
      <th>Emilee</th>
      <td>203</td>
    </tr>
    <tr>
      <th>Colleen</th>
      <td>206</td>
    </tr>
    <tr>
      <th>Cristina</th>
      <td>207</td>
    </tr>
    <tr>
      <th>Zaret</th>
      <td>214</td>
    </tr>
    <tr>
      <th>Betsy</th>
      <td>217</td>
    </tr>
    <tr>
      <th>Jen</th>
      <td>217</td>
    </tr>
    <tr>
      <th>Cici</th>
      <td>230</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Calculate the total revenue for each given product sold by each salesperson.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                  <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Dollars&#39;</span><span class="p">,</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> 
                  <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>  
                  <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Product</th>
      <th>eye liner</th>
      <th>foundation</th>
      <th>lip gloss</th>
      <th>lipstick</th>
      <th>mascara</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ashley</th>
      <td>5844.95</td>
      <td>4186.06</td>
      <td>6053.67</td>
      <td>3245.46</td>
      <td>6617.10</td>
      <td>25947.24</td>
    </tr>
    <tr>
      <th>Betsy</th>
      <td>6046.51</td>
      <td>8043.48</td>
      <td>5675.65</td>
      <td>3968.62</td>
      <td>4827.22</td>
      <td>28561.48</td>
    </tr>
    <tr>
      <th>Cici</th>
      <td>5982.83</td>
      <td>6198.22</td>
      <td>5199.96</td>
      <td>3148.83</td>
      <td>7060.71</td>
      <td>27590.55</td>
    </tr>
    <tr>
      <th>Colleen</th>
      <td>3389.61</td>
      <td>6834.76</td>
      <td>5573.35</td>
      <td>2346.39</td>
      <td>6746.54</td>
      <td>24890.65</td>
    </tr>
    <tr>
      <th>Cristina</th>
      <td>5397.30</td>
      <td>5290.97</td>
      <td>5298.00</td>
      <td>2401.68</td>
      <td>5461.64</td>
      <td>23849.59</td>
    </tr>
    <tr>
      <th>Emilee</th>
      <td>7587.37</td>
      <td>5313.82</td>
      <td>5270.26</td>
      <td>2189.15</td>
      <td>4719.34</td>
      <td>25079.94</td>
    </tr>
    <tr>
      <th>Hallagan</th>
      <td>6964.64</td>
      <td>6985.80</td>
      <td>5603.10</td>
      <td>3177.88</td>
      <td>5703.32</td>
      <td>28434.74</td>
    </tr>
    <tr>
      <th>Jen</th>
      <td>7010.45</td>
      <td>5628.65</td>
      <td>5461.65</td>
      <td>3953.28</td>
      <td>6887.21</td>
      <td>28941.24</td>
    </tr>
    <tr>
      <th>Zaret</th>
      <td>8166.73</td>
      <td>6451.66</td>
      <td>5670.33</td>
      <td>2448.71</td>
      <td>3879.94</td>
      <td>26617.37</td>
    </tr>
    <tr>
      <th>All</th>
      <td>56390.39</td>
      <td>54933.42</td>
      <td>49805.97</td>
      <td>26880.00</td>
      <td>51903.02</td>
      <td>239912.80</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result above also show the total. In Panda pivot_table(), we can simply pass <code class="docutils literal notranslate"><span class="pre">margins=True</span></code>.</p>
<ol class="arabic simple" start="3">
<li><p>Determine the total revenue generated by each salesperson, further broken down by location.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;Location&#39;</span><span class="p">],</span>
                 <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Dollars&#39;</span><span class="p">,</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Dollars</th>
    </tr>
    <tr>
      <th>Name</th>
      <th>Location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Ashley</th>
      <th>east</th>
      <td>7772.70</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>4985.90</td>
    </tr>
    <tr>
      <th>south</th>
      <td>7398.58</td>
    </tr>
    <tr>
      <th>west</th>
      <td>5790.06</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Betsy</th>
      <th>east</th>
      <td>8767.41</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>4878.07</td>
    </tr>
    <tr>
      <th>south</th>
      <td>7732.04</td>
    </tr>
    <tr>
      <th>west</th>
      <td>7183.96</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Cici</th>
      <th>east</th>
      <td>5956.31</td>
    </tr>
    <tr>
      <th>midwest</th>
      <td>8129.60</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Compute the total revenue for each salesperson within a specified year.</p></li>
</ol>
<p>To generate a yearly report with Panda pivot_table(), here are the steps:</p>
<ol class="arabic simple">
<li><p>Defines a groupby instruction using Grouper() with key=’Date’ and freq=’Y’.</p></li>
<li><p>Applies pivot_table.</p></li>
</ol>
<p><strong>Note</strong> To group our data depending on the specified frequency for the specified column, we’ll use <code class="docutils literal notranslate"><span class="pre">pd.Grouper(key=INPUT</span> <span class="pre">COLUMN&gt;,</span> <span class="pre">freq=DESIRED</span> <span class="pre">FREQUENCY&gt;)</span></code>. The frequency in our situation is ‘Y’ and the relevant column is ‘Date.’</p>
<p>Different standard frequencies, such as ‘D’,’W’,’M’, or ‘Q’, can be used instead of ‘Y.’ Check out the following for a list of less common useable frequencies, <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_gp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">year_gp</span><span class="p">)</span>

<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">year_gp</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Dollars&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TimeGrouper(key=&#39;Date&#39;, freq=&lt;YearEnd: month=12&gt;, axis=0, sort=True, dropna=True, closed=&#39;right&#39;, label=&#39;right&#39;, how=&#39;mean&#39;, convention=&#39;e&#39;, origin=&#39;start_day&#39;)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Date</th>
      <th>2004-12-31</th>
      <th>2005-12-31</th>
      <th>2006-12-31</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ashley</th>
      <td>9495.09</td>
      <td>9547.53</td>
      <td>6904.62</td>
    </tr>
    <tr>
      <th>Betsy</th>
      <td>9420.24</td>
      <td>9788.70</td>
      <td>9352.54</td>
    </tr>
    <tr>
      <th>Cici</th>
      <td>8965.25</td>
      <td>9024.96</td>
      <td>9600.34</td>
    </tr>
    <tr>
      <th>Colleen</th>
      <td>9361.37</td>
      <td>7996.81</td>
      <td>7532.47</td>
    </tr>
    <tr>
      <th>Cristina</th>
      <td>9132.12</td>
      <td>7976.34</td>
      <td>6741.13</td>
    </tr>
    <tr>
      <th>Emilee</th>
      <td>7805.66</td>
      <td>9326.44</td>
      <td>7947.84</td>
    </tr>
    <tr>
      <th>Hallagan</th>
      <td>10676.88</td>
      <td>9102.52</td>
      <td>8655.34</td>
    </tr>
    <tr>
      <th>Jen</th>
      <td>9049.31</td>
      <td>8920.30</td>
      <td>10971.63</td>
    </tr>
    <tr>
      <th>Zaret</th>
      <td>9078.51</td>
      <td>8639.68</td>
      <td>8899.18</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Exercise</p>
<p>Apply pivot_table (in new worksheets) to answer the following questions.</p>
<ol class="arabic simple" start="5">
<li><p>How many saleperson are there? Hint: use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> to create a grouped DataFrame grouped by salepersons and then call <code class="docutils literal notranslate"><span class="pre">groups</span></code> on the grouped object, which will returns the list of indices for every group.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_person</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grouped_person</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">len</span><span class="p">(</span><span class="n">grouped_person</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;Ashley&#39;, &#39;Betsy&#39;, &#39;Cici&#39;, &#39;Colleen&#39;, &#39;Cristina&#39;, &#39;Emilee&#39;, &#39;Hallagan&#39;, &#39;Jen&#39;, &#39;Zaret&#39;])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Dealing_with_Problematic_Data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dealing with Problematic Data</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-new-column-to-an-existing-pandas-dataframe">Add A New Column To An Existing Pandas DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appending-a-row-to-a-dataframe-and-specify-its-index-label">Appending a row to a dataframe and specify its index label</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting">Sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-data">Grouping Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-pivot-tables">Introduction to Pivot Tables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplest-pivot-table">Simplest Pivot table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-non-numeric-columns-in-pivot-tables">Handling Non-Numeric Columns in Pivot Tables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-values-and-performing-aggregation">Specifying values and performing aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seeing-break-down-using-columns">Seeing break down using columns</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions-to-exercise">Solutions to Exercise</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>